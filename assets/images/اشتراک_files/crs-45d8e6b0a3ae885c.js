(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4856],{8045:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/crs",function(){return n(84634)}])},56300:function(e,t,n){"use strict";var s=n(85893),r=n(67294),l=n(11163),a=n(27511),i=n(31955);t.Z=e=>{let{children:t}=e,{isAuthenticated:n}=(0,a.a)(),o=i.Z.get("authToken"),c=i.Z.get("property"),d=(0,l.useRouter)();return(0,r.useEffect)(()=>{o||d.push("/login")},[o,d]),(0,r.useEffect)(()=>{c||d.push("/login")},[c,d]),(0,s.jsx)(s.Fragment,{children:t})}},11354:function(e,t,n){"use strict";var s=n(85893),r=n(24155),l=n(24486),a=n(67421);t.Z=e=>{let{steps:t}=e,{t:n}=(0,a.$G)();return(0,s.jsx)(r.Z,{className:"mt-2 mx-2",items:[{href:"/",title:(0,s.jsx)(l.Z,{size:18})},...t]})}},84634:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return O}});var s=n(85893),r=n(43907),l=n(16993),a=n(67294),i=n(15978),o=n(61029),c=n(39897),d=n(37887),u=n(43564),x=n(78605),m=n(33479),f=n(89157),h=n(12930),p=n(26036),v=n(14182),g=n(11354),y=n(67421),j=n(22277),b=n(50686),w=n(26225),N=n(74606),k=n(38937),P=n(27840),Z=n(11163),C=n(86738),T=n(41664),A=n.n(T),L=n(8575),S=n(56300),F=n(3067),I=n.n(F),$=n(68049),M=n(2962),B=n(40275),E=n(39338),R=n(12213),q=n(46237),_=n(44192),D=(0,a.memo)(e=>{var t;let{event:n,children:r}=e,{t:l}=(0,y.$G)(),a=e=>(0,s.jsxs)(m.Z,{vertical:!0,gap:14,className:"py-2 px-4 cursor-pointer hover:bg-neutral-100 rounded-xl transition ease-in-out",children:[(0,s.jsxs)(m.Z,{vertical:!0,children:[(0,s.jsxs)("div",{className:"flex flex-row items-center justify-between mb-1",children:[(0,s.jsx)("p",{className:"font-semibold text-primary",children:"رزرواسیون نیما میرخوانی"})," "]}),(0,s.jsx)("p",{className:"font-semibold",children:"2024/02/14 - 20:25"})]}),(0,s.jsx)("p",{className:"text-[9px] text-center",children:(0,s.jsx)("span",{children:"نام و نام خانوادگی را از فرامرزی به میرخوانی تیغییر دادیم"})})]}),i=[{key:"1",label:l("Reservation"),children:(0,s.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,s.jsx)(A(),{href:"/crs/reservation/".concat(n.event.extendedProps.id),children:(0,s.jsxs)(h.ZP,{block:!0,className:"flex flex-row items-center justify-between bg-zinc-100 border-0 ",children:[(0,s.jsxs)("p",{className:"text-black",children:[l("Reservation Detail")," "]}),(0,s.jsx)(_.Z,{variant:"Bulk",className:"text-primary"})]})}),(0,s.jsx)(A(),{href:"/crs/reservation/".concat(n.event.extendedProps.id),children:(0,s.jsxs)(h.ZP,{block:!0,className:"flex flex-row items-center justify-between bg-zinc-100 border-0",children:[(0,s.jsxs)("p",{className:"text-black",children:[" ",l("Change Room")]}),(0,s.jsx)(_.Z,{variant:"Bulk",className:"text-primary"})]})})]})},{key:"2",label:l("Notes"),children:(0,s.jsx)(B.Z,{size:"small",pagination:{pageSize:2},dataSource:[1,2,3,4],renderItem:e=>(0,s.jsx)(a,{item:e})})}];return(0,s.jsx)(E.Z,{placement:"left",trigger:["click"],content:(0,s.jsxs)(m.Z,{gap:24,children:[(0,s.jsxs)("div",{className:"bg-primary min-h-36 rounded-[30px] flex flex-col p-2 gap-y-4 pb-4",children:[(0,s.jsxs)("div",{className:"flex flex-row bg-white rounded-3xl  items-center gap-x-6 px-2",children:[(0,s.jsxs)("span",{className:"flex flex-col ps-4 py-2",children:[(0,s.jsx)("p",{className:"font-bold text-xs",children:null===(t=n.event.extendedProps)||void 0===t?void 0:t.title}),(0,s.jsx)("p",{className:"text-xs",children:"00988123712"})]}),(0,s.jsx)(R.Z,{color:"success",children:l("Reservation")})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-y-2 px-3",children:[(0,s.jsx)("p",{className:"text-white font-bold text-xs",children:l("Checkin/ Checkout")}),(0,s.jsxs)("span",{className:"text-white text-xs",children:[I()(n.event.extendedProps.checkedIn).locale("fa").format("YYYY/MM/D")," ","-"," ",I()(n.event.extendedProps.checkedOut).locale("fa").format("YYYY/MM/D")]})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-y-2 px-3",children:[(0,s.jsx)("p",{className:"text-white font-bold text-xs",children:l("Guests")}),(0,s.jsx)("span",{className:"text-white text-xs",children:"1"})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-y-2 px-3",children:[(0,s.jsx)("p",{className:"text-white font-bold text-xs",children:l("Total")}),(0,s.jsx)("span",{className:"text-white text-xs",children:"5,300,000 تومان"})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-y-2 px-3",children:[(0,s.jsx)("p",{className:"text-white font-bold text-xs",children:l("Balance")}),(0,s.jsx)("span",{className:"text-white text-xs",children:"5,300,000 تومان"})]})]}),(0,s.jsx)("div",{className:"flex flex-col gap-y-2",children:(0,s.jsx)(q.Z,{defaultActiveKey:"1",items:i})})]}),children:r})}),O=()=>{let[e,t]=(0,a.useState)([]),n=(0,a.useRef)(null),{t:T,i18n:F}=(0,y.$G)(),B=(0,Z.useRouter)(),{isDarkMode:E}=(0,L.useTheme)(),[R,q]=(0,a.useState)([]),[_,O]=(0,a.useState)([]),{data:H}=(0,d.a)($.C,{variables:{args:{isActive:!0}}});(0,d.a)(u.y,{notifyOnNetworkStatusChange:!0,fetchPolicy:"network-only",onCompleted:e=>{var n;let{roomTypes:s}=e,r=[],l=[];null==s||null===(n=s.data)||void 0===n||n.map(async e=>{var t,n;let s=[{slug:"sat",value:6},{slug:"sun",value:0},{slug:"mon",value:1},{slug:"tue",value:2},{slug:"wed",value:3},{slug:"thu",value:4},{slug:"fri",value:5}];await (null===(t=e.rate)||void 0===t?void 0:t.weeklyRates.filter(async(t,n)=>{let r=s.find(e=>e.slug===t.slug);if(r){var a,i;let n={id:t.id,resourceId:null===(a=e.id)||void 0===a?void 0:a.toString(),height:80,classNames:"calendar-long",title:(0,x.aw)((0,x.fN)(t.basicRate))+" تومان",daysOfWeek:[null==r?void 0:r.value],extendedProps:{tag:"rate",color:"red",rooms:null==e?void 0:null===(i=e.rooms)||void 0===i?void 0:i.filter(e=>"Unoccupied"===e.status).length}};l.push(n)}})),r.push({id:e.id,title:"".concat(T(e.title)," ").concat((0,x.Qm)(e.title).toUpperCase()),height:80,classNames:"calendar-long",style:{"font-size":"10px"},...e.rooms&&{children:null==e?void 0:null===(n=e.rooms)||void 0===n?void 0:n.map(e=>({id:e.id,height:28,classNames:"calendar-short",style:{"font-weight":"100"},title:"".concat(e.title," (").concat(e.roomNumber,") "),extendedProps:{status:e.status}}))}})}),q([...R,...l]),t(r)}}),(0,d.a)(C.p,{onCompleted:e=>{var t;let{reservations:s}=e,r=[];null==s||null===(t=s.data)||void 0===t||t.map(e=>{var t;let n="notPaid";if(e.folios.length>0){let t=e.folios.every(e=>e.isPaid),s=e.folios.some(e=>e.isPaid);n=t?"isPaid":s?"partialPaid":"notPaid"}else n="notPaid";null==e||null===(t=e.details)||void 0===t||t.map(t=>{var s;r.push({id:t.id,resourceId:null==t?void 0:null===(s=t.room)||void 0===s?void 0:s.id,title:"event 1",height:28,start:t.checkedIn,end:t.checkedOut,allDay:!1,editable:!0,isEdit:!1,resourceEditable:!1,description:"Lale sabouri",operations:[1,2,3,4,5],calendarId:"c1",isMaintenance:!1,autoSchedule:!1,extendedProps:{tag:"room",color:"red",status:t.status,title:e.title,id:e.id,rooms:0,paymentStatus:n,...t}})})}),n.current&&O(r.map(e=>e.resourceId)),q([...R,...r])}});let Y=()=>{let e=document.querySelector("#current-date");if(e){let t=document.querySelector(".fc-toolbar-title").innerHTML;e.innerHTML=t}},z=e=>{let t=n.current.getApi();"customToday"===e?t.today():"customNext"===e?t.next():"customPrev"===e&&t.prev(),Y()};return(0,a.useEffect)(()=>{Y()},[e]),(0,a.useEffect)(()=>{let t='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2" d="M19.92 8.95l-6.52 6.52c-.77.77-2.03.77-2.8 0L4.08 8.95"></path></svg>',n='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2" d="M15 19.92L8.48 13.4c-.77-.77-.77-2.03 0-2.8L15 4.08"></path></svg>';e.forEach(e=>{let s=document.querySelector('[data-resource-id="'.concat(e.id,'"]'));if(s){let e=null==s?void 0:s.querySelectorAll(".fc-datagrid-expander")[0],r=e.querySelectorAll(".fc-icon.fc-icon-minus-square")[0],l=e.querySelectorAll(".fc-icon.fc-icon-plus-square")[0];l&&(l.addEventListener("click",()=>{let s=e.querySelectorAll(".fc-icon.fc-icon-minus-square")[0];l.innerHTML=t,s&&(s.innerHTML=n)}),l.innerHTML=n),r&&(r.addEventListener("click",()=>{let l=e.querySelectorAll(".fc-icon.fc-icon-plus-square")[0];s.classList.toggle("open-room"),r.innerHTML=n,l&&(l.innerHTML=t)}),r.innerHTML=t),s&&s.classList.add("head-resource-style")}})},[e]),(0,s.jsxs)(S.Z,{children:[(0,s.jsx)(M.PB,{title:T("Calendar")}),(0,s.jsxs)("div",{className:"flex flex-row justify-between mb-2",children:[(0,s.jsx)(g.Z,{steps:[{href:"/",title:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("span",{className:"font-light",children:T("Dashboard")})})},{href:"/crs",title:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("span",{className:"font-bold",children:T("Property management system")})})}]}),(0,s.jsxs)("div",{className:"flex flex-row space-x-4 rtl:space-x-reverse",children:[(0,s.jsxs)(h.ZP,{onClick:()=>B.push("/crs/reservations/add"),className:"text-black hover:bg-primary hover:text-primary-foreground border-0 bg-primary flex flex-row space-x-2 rtl:space-x-reverse",children:[(0,s.jsx)(j.Z,{}),(0,s.jsxs)("p",{className:"text-black",children:[" ",T("Add reservation")]})]}),(0,s.jsx)(A(),{href:"/crs/reservations/list",children:(0,s.jsx)(h.ZP,{children:T("Reservations")})})]})]}),(0,s.jsx)(p.Z,{bordered:!1,bodyStyle:{padding:0},className:"overflow-hidden rounded-xl ".concat(E&&"dark-table"," bg-transparent"),children:(0,s.jsx)(r.Z,{ref:n,resourcesInitiallyExpanded:!1,events:R,plugins:[c.ZP,i.Z,l.Z,o.Z],eventClassNames:e=>[e.event.classNames,e.view.type].flat(),firstDay:6,direction:"ir"===F.language?"rtl":"ltr",headerToolbar:{start:"title",center:void 0,end:void 0},titleFormat:{weekday:void 0,month:"short",day:void 0},initialView:"customWeeks",slotLabelContent:e=>{var t,n;let r=0,l=null==H?void 0:null===(n=H.rooms)||void 0===n?void 0:null===(t=n.paginatorInfo)||void 0===t?void 0:t.total;return R.map(t=>{t.start&&t.end&&I()(e.date).isBetween(I()(t.start),I()(t.end),"day","[]")&&(r+=1)}),(0,s.jsxs)(m.Z,{vertical:!0,justify:"center",align:"center",children:[(0,s.jsx)("span",{className:"border border-primary rounded-full p-0 text-primary flex flex-row justify-center mb-4 min-w-8 text-xs pt-[2px]",children:l-r}),(0,s.jsx)("p",{className:"text-orange-950 text-sm",children:e.text}),(0,s.jsx)(f.Z,{className:"mt-4",percent:Math.round(r/l*100),trailColor:"#E9E9E9",strokeColor:"#F9B233",size:[129,29],format:e=>(0,s.jsxs)("p",{className:"text-xs progress-info font-normal",children:["%",null!=e?e:0]})})]})},slotLabelFormat:[{weekday:"short",month:void 0,day:"numeric"}],views:{customWeeks:{resourceTimelineWeek:{slotLabelFormat:[{weekday:"short",month:"short",day:"numeric"}]},resourceTimelineMonth:{slotLabelFormat:[{weekday:"short",month:"short",day:"numeric"}]},resourceTimelineDay:{slotLabelFormat:[{weekday:"short",month:"short",day:"numeric",year:"numeric"}]},type:"resourceTimeline",duration:{weeks:2},slotDuration:{days:1},buttonText:T("Today")}},contentHeight:"auto",locale:"ir"===F.language?"fa":"en",resourceAreaWidth:"240px",weekNumbers:!1,resources:e,editable:!1,schedulerLicenseKey:"GPL-My-Project-Is-Open-Source",selectable:!1,selectMirror:!1,dayMaxEvents:!1,eventContent:e=>(function(e,t){if("rate"===e.event.extendedProps.tag)return(0,s.jsxs)("div",{className:"px-3 py-2 text-center justify-center event-item-cell",style:{color:t?"#fff":"#131313"},children:[(0,s.jsx)("span",{children:e.event.extendedProps.rooms}),(0,s.jsx)("p",{className:"font-medium",children:e.event.title})]});if("room"===e.event.extendedProps.tag){let t,n;switch(e.event.extendedProps.status){case"inProgress":t="#F5D870";break;case"confirmed":t="#1677FF";break;case"cancelled":t="#FF455C";break;case"reserved":t="#13C2C2";break;case"checkedIn":t="#2FAC66";break;case"checkedOut":t="#FF4D4F"}switch(e.event.extendedProps.paymentStatus){case"isPaid":n="#2FAC66";break;case"notPaid":n="#FF0000";break;case"partialPaid":n="#9B59B6"}return(0,s.jsx)("div",{className:"px-3 py-1 mr-1 text-center event-item justify-center rounded-tl-3xl rounded-tr-sm rounded-br-sm rounded-sm h-7 p-0 bg-opacity-30",style:{backgroundColor:"".concat(t,"4D"),borderColor:t,borderWidth:2,borderStyle:"solid",borderRight:8,borderRightColor:t,borderRightStyle:"solid"},children:(0,s.jsx)(D,{event:e,children:(0,s.jsxs)("p",{className:"text-black font-normal text-right",children:[(0,s.jsx)("div",{className:"h-4 w-4 rounded-full absolute left-0 -top-1",style:{backgroundColor:n}}),e.event.extendedProps.title]})})})}})(e,E),resourceAreaHeaderContent:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("span",{id:"current-date",className:"h-8 w-full flex flex-row items-center justify-center text-black rounded-full border border-primary",onClick:()=>z("customToday")}),(0,s.jsxs)("div",{className:"flex gap-x-[12px] justify-around w-full flex-row-reverse ",children:[(0,s.jsx)(v.Z,{title:T("Add reservation"),children:(0,s.jsx)(A(),{href:"/crs/reservations/add",className:"w-10 h-10 bg-primary flex flex-row items-center justify-center text-white rounded-full",children:(0,s.jsx)(j.Z,{})})}),(0,s.jsx)(v.Z,{title:T("Calendar"),children:(0,s.jsx)(A(),{href:"/crs",className:"w-10 h-10 bg-primary flex flex-row items-center justify-center text-white rounded-full",children:(0,s.jsx)(b.Z,{variant:"Bulk"})})}),(0,s.jsx)(v.Z,{title:T("Reservations"),children:(0,s.jsx)(A(),{href:"/crs/reservations/list",className:"w-10 h-10 bg-primary flex flex-row items-center justify-center text-white rounded-full",children:(0,s.jsx)(w.Z,{variant:"Bulk"})})}),(0,s.jsx)(v.Z,{title:T("Search"),children:(0,s.jsx)(A(),{href:"/crs",className:"w-10 h-10 bg-primary flex flex-row items-center justify-center text-white rounded-full",children:(0,s.jsx)(N.Z,{variant:"Bulk"})})})]}),(0,s.jsxs)("div",{className:"flex flex-row gap-x-[16.3px] bg-primary rounded-full justify-between items-center px-1",children:[(0,s.jsx)("button",{className:"w-8 h-8 flex flex-row items-center justify-center rounded-full bg-white text-primary",onClick:()=>z("customPrev"),children:(0,s.jsx)(k.Z,{variant:"Bulk"})}),(0,s.jsx)("button",{className:"h-10 flex flex-row items-center justify-center text-white px-5 text-lg",onClick:()=>z("customToday"),children:T("Today")}),(0,s.jsx)("button",{className:"w-8 h-8 flex flex-row items-center justify-center rounded-full bg-white text-primary",onClick:()=>z("customNext"),children:(0,s.jsx)(P.Z,{variant:"Bulk"})})]})]})})})]})}},86738:function(e,t,n){"use strict";n.d(t,{p:function(){return i}});var s=n(82729),r=n(68806),l=n(54910);function a(){let e=(0,s._)(["\n  query reservations($first: Int, $page: Int, $args: ReservationArgs) {\n    reservations(first: $first, page: $page, args: $args) {\n      paginatorInfo {\n        total\n      }\n      data {\n        id\n        title\n        description\n        status\n        arrivalDate\n        reservationNumber\n        fee\n        departureDate\n        hotel {\n          id\n          name\n        }\n        fee\n        booker {\n          firstName\n          lastName\n        }\n        folios {\n          id\n          isPaid\n          currency {\n            title\n          }\n        }\n        details {\n          id\n          checkedIn\n          checkedOut\n          status\n          room {\n            id\n            title\n            roomNumber\n            roomType {\n              id\n              title\n            }\n          }\n        }\n        source {\n          title\n        }\n        deletedAt\n        createdAt\n        updatedAt\n      }\n    }\n  }\n"]);return a=function(){return e},e}let i=(0,r.ZP)(a());(0,l.B)(i)},68049:function(e,t,n){"use strict";n.d(t,{C:function(){return i}});var s=n(82729),r=n(68806),l=n(54910);function a(){let e=(0,s._)(["\n  query rooms($first: Int, $page: Int, $args: RoomArgs) {\n    rooms(first: $first, page: $page, args: $args) {\n      paginatorInfo {\n        total\n      }\n      data {\n        id\n        title\n        slug\n        roomNumber\n        minimumStay\n        minimumOccupancy\n        maximumOccupancy\n        view\n        isActive\n        status\n        roomType {\n          id\n          title\n        }\n        hotel {\n          id\n          name\n        }\n        amenities {\n          id\n          title\n        }\n        bedTypes {\n          id\n          title\n          type\n        }\n        deletedAt\n        createdAt\n        updatedAt\n      }\n    }\n  }\n"]);return a=function(){return e},e}let i=(0,r.ZP)(a());(0,l.B)(i)},43564:function(e,t,n){"use strict";n.d(t,{y:function(){return i}});var s=n(82729),r=n(68806),l=n(54910);function a(){let e=(0,s._)(["\n  query roomTypes($first: Int, $page: Int, $args: RoomTypeArgs) {\n    roomTypes(first: $first, page: $page, args: $args) {\n      paginatorInfo {\n        total\n      }\n      data {\n        id\n        title\n        occupancy {\n          id\n          label\n        }\n        layout {\n          id\n          label\n        }\n        rooms {\n          id\n          title\n          slug\n          roomNumber\n          status\n        }\n        rate {\n          id\n          weeklyRates {\n            id\n            slug\n            basicRate\n          }\n        }\n        numberOfBeds\n        isActive\n        deletedAt\n        createdAt\n        updatedAt\n      }\n    }\n  }\n"]);return a=function(){return e},e}let i=(0,r.ZP)(a());(0,l.B)(i)}},function(e){e.O(0,[1069,6036,5930,9157,6162,9774,2888,179],function(){return e(e.s=8045)}),_N_E=e.O()}]);