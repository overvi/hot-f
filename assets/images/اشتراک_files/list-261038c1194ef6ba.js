(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[908],{89841:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/crs/reservations/list",function(){return t(32076)}])},11354:function(e,r,t){"use strict";var n=t(85893),a=t(24155),i=t(24486),s=t(67421);r.Z=e=>{let{steps:r}=e,{t}=(0,s.$G)();return(0,n.jsx)(a.Z,{className:"mt-2 mx-2",items:[{href:"/",title:(0,n.jsx)(i.Z,{size:18})},...r]})}},32076:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return G}});var n=t(85893),a=t(50319),i=t(73359),s=t(11354),l=t(82729),o=t(68806),d=t(54910);function u(){let e=(0,l._)(["\n  mutation deleteReservation($id: ID!) {\n    deleteReservation(id: $id) {\n      id\n    }\n  }\n"]);return u=function(){return e},e}let c=(0,o.ZP)(u());(0,d.B)(c);var v=t(86738),m=t(78605),x=t(22427),p=t(8453),f=t(85675),h=t(12213),g=t(33479),j=t(52232),Z=t(97845),b=t(89770),N=t(68616),y=t(26036),k=t(34579),w=t(12930),I=t(52152),D=t(19477),S=t(11631),P=t(18866),C=t(28688),_=t(22277),z=t(74606),A=t(9008),E=t.n(A),$=t(41664),R=t.n($),B=t(11163),F=t(67294),O=t(67421);let{RangePicker:T}=x.default;var G=()=>{var e,r,t,l,o,d,u,x;let{t:A,i18n:$}=(0,O.$G)(),G=(0,B.useRouter)(),[L,X]=(0,F.useState)(0),[q,M]=(0,F.useState)(),[Q,H]=(0,F.useState)(""),[J]=p.Z.useForm(),[K,U]=(0,F.useState)({page:1,pageSize:10}),[V]=(0,a.D)(c,{refetchQueries:[v.p],onCompleted:()=>{f.ZP.success({message:A("Item deleted successfully")})},onError:e=>{f.ZP.error({message:A(e.message)})}}),W=e=>{!0==window.confirm(A("Are you sure you wish to delete this item?"))&&V({variables:{id:parseInt(e)}})},Y=e=>{switch(e){case"canceled":return(0,n.jsx)(h.Z,{color:"red",children:A((0,m.l4)(e))});case"confirmed":return(0,n.jsx)(h.Z,{color:"geekblue",children:A((0,m.l4)(e))});case"paid":return(0,n.jsx)(h.Z,{color:"green",children:A((0,m.l4)(e))});case"inProgress":return(0,n.jsx)(h.Z,{color:"gold",children:A((0,m.l4)(e))});default:return(0,n.jsx)(h.Z,{color:"blue",children:"-"})}},ee=[{title:A("Reservation"),dataIndex:"reservationNumber",key:"reservationNumber",render:(e,r)=>(0,n.jsx)("p",{className:"text-xs",children:r.reservationNumber}),ellipsis:!0},{title:A("Name"),dataIndex:"name",key:"name",render:(e,r)=>{var t,a;return(0,n.jsxs)(g.Z,{align:"center",children:[null==r?void 0:null===(t=r.booker)||void 0===t?void 0:t.firstName," ",null==r?void 0:null===(a=r.booker)||void 0===a?void 0:a.lastName]})},sorter:(e,r)=>{var t,n;return null===(n=e.user)||void 0===n?void 0:n.firstName.localeCompare(null===(t=r.user)||void 0===t?void 0:t.firstName)},ellipsis:!0},{title:A("Date booked"),dataIndex:"created",key:"created",render:(e,r)=>(0,m.b2)(r.createdAt,$.language),sorter:(e,r)=>new Date(e.createdAt)-new Date(r.createdAt)},{title:A("Room numbers"),dataIndex:"rooms",key:"rooms",ellipsis:!0,render:(e,r)=>{var t;return(0,n.jsx)(g.Z,{gap:4,wrap:"wrap",children:null==r?void 0:null===(t=r.details)||void 0===t?void 0:t.map(e=>{var r;return(0,n.jsx)(h.Z,{children:null==e?void 0:null===(r=e.room)||void 0===r?void 0:r.roomNumber},e.id)})})}},{title:A("Arrival date"),dataIndex:"arrival",key:"arrival",render:(e,r)=>(0,m.b2)(null==r?void 0:r.arrivalDate,$.language),sorter:(e,r)=>new Date(e.arrivalDate)-new Date(r.arrivalDate)},{title:A("Departure date"),dataIndex:"departure",key:"departure",render:(e,r)=>(0,m.b2)(null==r?void 0:r.departureDate,$.language),sorter:(e,r)=>new Date(e.departureDate)-new Date(r.departureDate)},{title:A("Total price"),dataIndex:"totalprice",key:"totalprice",render:(e,r)=>{var t,n;return(null==r?void 0:r.fee)?(0,m.aw)((0,m.fN)(null==r?void 0:r.fee))+" "+A((0,m.uP)(null==r?void 0:null===(n=r.folios[0])||void 0===n?void 0:null===(t=n.currency)||void 0===t?void 0:t.title)):""},sorter:(e,r)=>e.fee-r.fee},{title:A("Status"),dataIndex:"status",key:"status",render:(e,r)=>Y(r.status),sorter:(e,r)=>e.status.localeCompare(r.status)},{title:A("Source"),dataIndex:"source",key:"source",render:(e,r)=>{var t;return A(null==r?void 0:null===(t=r.source)||void 0===t?void 0:t.title)},sorter:(e,r)=>{var t,n;return null===(n=e.source)||void 0===n?void 0:n.title.localeCompare(null===(t=r.source)||void 0===t?void 0:t.title)},ellipsis:!0},{title:A("Actions"),key:"action",render:(e,r)=>(0,n.jsxs)("div",{className:"flex-row flex space-x-2 rtl:space-x-reverse justify-center",children:[(0,n.jsx)(j.Z,{title:A("Sure to delete?"),onConfirm:()=>W(r.id),children:(0,n.jsx)(S.Z,{className:"text-red-600 cursor-pointer",size:24,variant:"Bulk"})}),(0,n.jsx)(Z.default.Link,{onClick:()=>G.push("/crs/reservation/".concat(r.id)),children:(0,n.jsx)(P.Z,{className:"text-zinc-500",size:22,variant:"Bulk"})}),(0,n.jsx)(Z.default.Link,{children:(0,n.jsx)(R(),{href:"/crs/reservation/".concat(r.id),children:(0,n.jsx)(C.Z,{className:"text-zinc-500",size:24,variant:"Bulk"})})})]})}],[er,{data:et,loading:en}]=(0,i.t)(v.p,{notifyOnNetworkStatusChange:!0,fetchPolicy:"network-only",onCompleted:e=>{let{reservations:r}=e,t=r.data,n=r.paginatorInfo.total;M(t),X(n)},onError:e=>{f.ZP.error({message:A("Error"),description:A(e.message)})}}),[ea,{data:ei,loading:es}]=(0,i.t)(v.p),[el,{data:eo,loading:ed}]=(0,i.t)(v.p),[eu,{data:ec,loading:ev}]=(0,i.t)(v.p);return(0,F.useEffect)(()=>{ea({variables:{args:{status:"inProgress"}}}),el({variables:{args:{status:"cancelled"}}}),eu({variables:{args:{status:"confirmed"}}})},[el,ea,eu]),(0,F.useEffect)(()=>{er({variables:{first:K.pageSize,page:K.page}})},[er,K]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(E(),{children:[(0,n.jsx)("title",{children:A("Finance")}),(0,n.jsx)("meta",{name:"description",content:"Mangotels | dashboard"}),(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsx)("main",{children:(0,n.jsxs)("div",{className:"App",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,n.jsx)(s.Z,{steps:[{href:"/crs/reservations/list",title:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("span",{className:"font-bold",children:A("Reservations")})})}]}),(0,n.jsx)(T,{})]}),(0,n.jsxs)(b.Z,{gutter:[16,16],children:[(0,n.jsx)(N.Z,{md:4,children:(0,n.jsx)(y.Z,{children:(0,n.jsx)(k.Z,{title:A("Reservations"),value:(0,m.aw)(L),loading:en})})}),(0,n.jsx)(N.Z,{md:4,children:(0,n.jsx)(y.Z,{children:(0,n.jsx)(k.Z,{title:A("In progress"),value:(0,m.aw)(null==ei?void 0:null===(r=ei.reservations)||void 0===r?void 0:null===(e=r.paginatorInfo)||void 0===e?void 0:e.total),loading:es})})}),(0,n.jsx)(N.Z,{md:4,children:(0,n.jsx)(y.Z,{children:(0,n.jsx)(k.Z,{title:A("Confirmed"),value:(0,m.aw)(null==ec?void 0:null===(l=ec.reservations)||void 0===l?void 0:null===(t=l.paginatorInfo)||void 0===t?void 0:t.total),loading:ed})})}),(0,n.jsx)(N.Z,{md:4,children:(0,n.jsx)(y.Z,{children:(0,n.jsx)(k.Z,{title:A("Canceled"),value:(0,m.aw)(null==eo?void 0:null===(d=eo.reservations)||void 0===d?void 0:null===(o=d.paginatorInfo)||void 0===o?void 0:o.total),loading:ev})})})]}),(0,n.jsx)(b.Z,{className:"mt-4",gutter:[16,16],children:(0,n.jsx)(N.Z,{md:24,children:(0,n.jsxs)(y.Z,{title:A("Reservations"),tabProps:{size:"middle"},bodyStyle:{padding:0},extra:(0,n.jsx)(R(),{href:"/crs/reservations/add",children:(0,n.jsxs)(w.ZP,{type:"primary",className:"text-black hover:bg-primary hover:text-primary-foreground border-0 items-center bg-primary flex flex-row space-x-2 rtl:space-x-reverse",children:[A("Add reservation"),(0,n.jsx)(_.Z,{})]})}),children:[(0,n.jsx)("div",{className:"my-3 mx-2",children:(0,n.jsxs)(p.Z,{name:"filter",layout:"inline",onFinish:e=>{er({variables:{first:K.pageSize,page:K.page,args:{reservationNumber:e.search}}})},form:J,children:[(0,n.jsx)(p.Z.Item,{name:"search",children:(0,n.jsx)(I.default,{placeholder:A("Search"),onChange:e=>H(e.target.value),value:Q,prefix:(0,n.jsx)(z.Z,{size:18,className:"text-neutral-400"})})}),(0,n.jsx)(w.ZP,{htmlType:"submit",children:A("Search")})]})}),(0,n.jsx)(D.Z,{dataSource:null==et?void 0:et.reservations.data,columns:ee,loading:en,onChange:e=>{U({page:e.current,pageSize:10})},pagination:{current:null==K?void 0:K.page,pageSize:10,total:null==et?void 0:null===(x=et.reservations)||void 0===x?void 0:null===(u=x.paginatorInfo)||void 0===u?void 0:u.total,hideOnSinglePage:!0}})]})})})]})})]})}},86738:function(e,r,t){"use strict";t.d(r,{p:function(){return l}});var n=t(82729),a=t(68806),i=t(54910);function s(){let e=(0,n._)(["\n  query reservations($first: Int, $page: Int, $args: ReservationArgs) {\n    reservations(first: $first, page: $page, args: $args) {\n      paginatorInfo {\n        total\n      }\n      data {\n        id\n        title\n        description\n        status\n        arrivalDate\n        reservationNumber\n        fee\n        departureDate\n        hotel {\n          id\n          name\n        }\n        fee\n        booker {\n          firstName\n          lastName\n        }\n        folios {\n          id\n          isPaid\n          currency {\n            title\n          }\n        }\n        details {\n          id\n          checkedIn\n          checkedOut\n          status\n          room {\n            id\n            title\n            roomNumber\n            roomType {\n              id\n              title\n            }\n          }\n        }\n        source {\n          title\n        }\n        deletedAt\n        createdAt\n        updatedAt\n      }\n    }\n  }\n"]);return s=function(){return e},e}let l=(0,a.ZP)(s());(0,i.B)(l)}},function(e){e.O(0,[5675,6036,7415,9477,7845,2427,5930,8030,1546,9774,2888,179],function(){return e(e.s=89841)}),_N_E=e.O()}]);